---
import type { ProductItemHomeAstro } from "@/shared/types";
import SquareProductCard from "./home/SquareProductCard.astro";

// todo : colocar bien las url con los lenguajes y colocar productos variados

const getDelay = (
  i: number,
  j: number,
  n: number,
  productRowN: number,
): number => {
  const mitad = Math.floor(n / 2) + 1;
  const mitadRow = Math.floor(productRowN / 2) + 1;
  if (i === mitad && j === mitadRow) return 0;
  if (i < mitad)
    return (mitad - i) * 0.2 + (mitadRow === j ? 0 : mitadRow > j ? 0.1 : 0.2);
  return (i - mitad) * 0.2 + (mitadRow === j ? 0 : mitadRow > j ? 0.1 : 0.2);
};

const products: ProductItemHomeAstro[][] = [
  [
    {
      name: 'airfryer',
      url: '/productos/airfryer',
      photo: '/home/5.webp',
      isMagic: false,
      bgColor: 1
    },
    {
      name: 'hervidoras',
      url: '/productos/hervidoras',
      photo: '/home/13.webp',
      isMagic: false,
      bgColor: 0
    },
    {
      name: 'hervidoras',
      url: '/productos/hervidoras',
      photo: '/home/13.webp',
      isMagic: false,
      bgColor: 2
    }
  ],
  [
    {
      name: 'airfryer',
      url: '/productos/airfryer',
      photo: '/home/5.webp',
      isMagic: false,
      bgColor: 2
    },
    {
      name: 'hervidoras',
      url: '/productos/hervidoras',
      photo: '/home/13.webp',
      isMagic: false,
      bgColor: 3
    },
    {
      name: 'hervidoras',
      url: '/productos/hervidoras',
      photo: '/home/13.webp',
      isMagic: false,
      bgColor: 2
    }
  ],
  [
    {
      name: 'airfryer',
      url: '/productos/airfryer',
      photo: '/home/5.webp',
      isMagic: false,
      bgColor: 2
    },
    {
      name: 'hervidoras',
      url: '/productos/hervidoras',
      photo: '/home/13.webp',
      isMagic: false,
      bgColor: 2
    },
    {
      name: 'hervidoras',
      url: '/productos/hervidoras',
      photo: '/home/13.webp',
      isMagic: false,
      bgColor: 0
    }
  ],
  [
    {
      name: 'airfryer',
      url: '/productos/airfryer',
      photo: '/home/5.webp',
      isMagic: false,
      bgColor: 0
    },
    {
      name: 'hervidoras',
      url: '/productos/hervidoras',
      photo: '/home/13.webp',
      isMagic: false,
      bgColor: 0
    },
    {
      name: 'hervidoras',
      url: '/productos/hervidoras',
      photo: '/home/13.webp',
      isMagic: false,
      bgColor: 1
    }
  ],
  [
    {
      name: 'airfryer',
      url: '/productos/airfryer',
      photo: '/home/5.webp',
      isMagic: false,
      bgColor: 2
    },
    {
      name: 'hervidoras',
      url: '/productos/hervidoras',
      photo: '/home/13.webp',
      isMagic: false,
      bgColor: 3
    },
    {
      name: 'hervidoras',
      url: '/productos/hervidoras',
      photo: '/home/13.webp',
      isMagic: false,
      bgColor: 1
    }
  ],
  [
    {
      name: 'airfryer',
      url: '/productos/airfryer',
      photo: '/home/6.webp',
      isMagic: false,
      bgColor: 2
    },
    {
      name: 'airfryer',
      url: '/productos/airfryer',
      photo: '/home/3.webp',
      isMagic: false,
      bgColor: 1
    },
    {
      name: 'arroceras',
      url: '/productos/arroceras',
      photo: '/home/11.webp',
      isMagic: false,
      bgColor: 2
    }
  ],
  [
    {
      name: 'airfryer',
      url: '/productos/airfryer',
      photo: '/home/2.webp',
      isMagic: false,
      bgColor: 1
    },
    {
      name: 'arroceras',
      url: '/productos/arroceras',
      photo: '/home/10.webp',
      isMagic: false,
      bgColor: 1
    },
    {
      name: 'scooters',
      url: '/productos/scooters',
      photo: '/home/14.webp',
      isMagic: false,
      bgColor: 2
    }
  ],
  [
    {
      name: 'hervidoras',
      url: '/productos/aires',
      photo: '/home/15.webp',
      isMagic: false,
      bgColor: 0
    },
    {
      name: 'Tu marca\nfavorita',
      url: '/',
      photo: '/home/logo.webp',
      isMagic: true,
      bgColor: 1
    },
    {
      name: 'airfryer',
      url: '/productos/airfryer',
      photo: '/home/4.webp',
      isMagic: false,
      bgColor: 0
    }
  ],
  [
    {
      name: 'licuadora',
      url: '/productos/licuadoras',
      photo: '/home/9.webp',
      isMagic: false,
      bgColor: 3
    },
    {
      name: 'hervidoras',
      url: '/productos/hervidoras',
      photo: '/home/12.webp',
      isMagic: false,
      bgColor: 2
    },
    {
      name: 'beauty',
      url: '/productos/beauty',
      photo: '/home/20.webp',
      isMagic: false,
      bgColor: 0
    }
  ],
  [
    {
      name: 'beauty',
      url: '/productos/beauty',
      photo: '/home/17.webp',
      isMagic: false,
      bgColor: 1
    },
    {
      name: 'planchas',
      url: '/productos/planchas',
      photo: '/home/19.webp',
      isMagic: false,
      bgColor: 3
    },
    {
      name: 'cocinas',
      url: '/productos/cocinas',
      photo: '/home/18.webp',
      isMagic: false,
      bgColor: 3
    }
  ],
  [
    {
      name: 'licuadora',
      url: '/productos/licuadoras',
      photo: '/home/7.webp',
      isMagic: false,
      bgColor: 0
    },
    {
      name: 'airfryer',
      url: '/productos/tvs',
      photo: '/home/16.webp',
      isMagic: false,
      bgColor: 1
    },
    {
      name: 'airfryer',
      url: '/productos/tvs',
      photo: '/home/16.webp',
      isMagic: false,
      bgColor: 2
    }
  ],
  [
    {
      name: 'licuadora',
      url: '/productos/licuadoras',
      photo: '/home/7.webp',
      isMagic: false,
      bgColor: 0
    },
    {
      name: 'airfryer',
      url: '/productos/tvs',
      photo: '/home/16.webp',
      isMagic: false,
      bgColor: 3
    },
    {
      name: 'airfryer',
      url: '/productos/tvs',
      photo: '/home/16.webp',
      isMagic: false,
      bgColor: 3
    }
  ],
  [
    {
      name: 'licuadora',
      url: '/productos/licuadoras',
      photo: '/home/7.webp',
      isMagic: false,
      bgColor: 2
    },
    {
      name: 'airfryer',
      url: '/productos/tvs',
      photo: '/home/16.webp',
      isMagic: false,
      bgColor: 3
    },
    {
      name: 'airfryer',
      url: '/productos/tvs',
      photo: '/home/16.webp',
      isMagic: false,
      bgColor: 1
    }
  ],
  [
    {
      name: 'licuadora',
      url: '/productos/licuadoras',
      photo: '/home/7.webp',
      isMagic: false,
      bgColor: 1
    },
    {
      name: 'airfryer',
      url: '/productos/tvs',
      photo: '/home/16.webp',
      isMagic: false,
      bgColor: 1
    },
    {
      name: 'airfryer',
      url: '/productos/tvs',
      photo: '/home/16.webp',
      isMagic: false,
      bgColor: 1
    }
  ],
  [
    {
      name: 'licuadora',
      url: '/productos/licuadoras',
      photo: '/home/7.webp',
      isMagic: false,
      bgColor: 1
    },
    {
      name: 'airfryer',
      url: '/productos/tvs',
      photo: '/home/16.webp',
      isMagic: false,
      bgColor: 2
    },
    {
      name: 'airfryer',
      url: '/productos/tvs',
      photo: '/home/16.webp',
      isMagic: false,
      bgColor: 1
    }
  ]
]

const allBgColors = [
  "bg-interbrasGreen-700",
  "bg-interbrasGreen-500",
  "bg-interbrasGreen-500",
  "bg-interbrasGreen-700",
];


---

<div id="ProductColumns" class="flex gap-3 justify-center items-center  w-dvw overflow-y-visible overflow-x-clip h-min  mt-[4rem] ">
    {
        products.map((productColumn, ColumnIndex) => (
          <div 
            id="ProductRows"
            class=" flex flex-col gap-2 shrink-0 ">
            {productColumn.map((productRow, RowIndex) => (
              <SquareProductCard
                href={productRow.url}
                src={productRow.photo}
                alt={productRow.name}
                isMagic={productRow.isMagic}
                delay = {
                    getDelay(
                      ColumnIndex + 1,
                      RowIndex + 1,
                      products.length,
                      productColumn.length,
                    )
                }
                bgColor = {
                    allBgColors[productRow.bgColor]
                }
              >
              </SquareProductCard>
            ))}
          </div>
        ))
    }
</div>


<style is:global>

  #product-card{
    opacity: 0;
  }

  @keyframes fade-in {
    100% {
      opacity: 1;
    }
  }

</style>